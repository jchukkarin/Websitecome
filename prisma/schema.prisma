generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-1.1.x", "debian-openssl-3.0.x", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
}

model User {
  id            String         @id @default(uuid())
  name          String?
  email         String         @unique
  password      String?
  createdAt     DateTime       @default(now())
  image         String?
  username      String?        @unique
  role          Role           @default(EMPLOYEE)
  consignments  Consignment[]
  notifications Notification[]
}

model Notification {
  id        String    @id @default(uuid())
  userId    String
  title     String
  message   String
  type      String
  isSent    Boolean   @default(false)
  sentAt    DateTime?
  createdAt DateTime  @default(now())
  user      User      @relation(fields: [userId], references: [id])
}

model Consignment {
  id            String             @id @default(uuid())
  date          DateTime
  lot           String
  consignorName String
  contactNumber String
  address       String
  totalPrice    Float
  createdAt     DateTime           @default(now())
  type          String             @default("INCOME")
  userId        String?
  statusId      Int?
  status        ConsignmentStatus? @relation(fields: [statusId], references: [id])
  user          User?              @relation(fields: [userId], references: [id])
  images        ConsignmentImage[]
  items         ConsignmentItem[]
}

model ConsignmentStatus {
  id           Int           @id @default(autoincrement())
  name         String        @unique
  consignments Consignment[]
}

model ConsignmentImage {
  id            String      @id @default(uuid())
  imageUrl      String
  consignmentId String
  consignment   Consignment @relation(fields: [consignmentId], references: [id])
}

model ConsignmentItem {
  id               String      @id @default(uuid())
  productName      String
  category         String
  year             String
  status           String      @default("ready")
  confirmedPrice   Float       @default(0)
  salesChannel     String?
  imageUrl         String?
  consignmentId    String
  slipImage        String?
  soldAt           DateTime?
  isReserveOpen    String?     @default("false")
  repairStatus     String      @default("NOT_REPAIR")
  reserveDays      String?
  reserveEndDate   String?
  reserveStartDate String?
  salesPrice       Float?      @default(0)
  repairEndDate    DateTime?
  repairStartDate  DateTime?
  consignment      Consignment @relation(fields: [consignmentId], references: [id])
}

model ShopProfile {
  id          String   @id @default("default")
  shopName    String   @default("-")
  address     String   @default("-")
  subDistrict String   @default("-")
  district    String   @default("-")
  province    String   @default("-")
  zipCode     String   @default("-")
  line        String?
  shopee      String?
  facebook    String?
  phone       String?
  updatedAt   DateTime @updatedAt
}

model ImportStatus {
  id        Int       @id @default(autoincrement())
  name      String
  createdAt DateTime  @default(now())
  products  Product[]
}

model Product {
  id             Int           @id @default(autoincrement())
  name           String
  importStatusId Int
  createdAt      DateTime      @default(now())
  isSold         Boolean       @default(false)
  payoutStatusId Int?
  soldAt         DateTime?
  defectImages   String[]
  images         String[]
  slipImage      String?
  status         String        @default("ready")
  importStatus   ImportStatus  @relation(fields: [importStatusId], references: [id])
  payoutStatus   PayoutStatus? @relation(fields: [payoutStatusId], references: [id])
}

model PayoutStatus {
  id        Int       @id @default(autoincrement())
  name      String
  createdAt DateTime  @default(now())
  products  Product[]
}

enum Role {
  MANAGER
  EMPLOYEE
}

enum RepairStatus {
  NOT_REPAIR
  REPAIRING
  REPAIRED
  RETURN_CUSTOMER
}
